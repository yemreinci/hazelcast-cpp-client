name: Codestyle Checker

on:
  - pull_request

jobs:
  check-formatting:
    runs-on: ubuntu-20.04

    steps:
      - name: Install clang-format
        run: sudo apt-get install clang-format

      - uses: actions/checkout@v2

      - name: Run clang-format
        run: |
          cd $GITHUB_WORKSPACE && \
          clang-format --dry-run -Werror \
            $(find . | \
              grep -E "\.(cpp|h)$" | \
              grep -v "generated-sources|cpp-controller")
